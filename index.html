<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš¾ ìˆ«ì ì•¼êµ¬ ê²Œì„ (ëª¨ë°”ì¼)</title>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            text-align: center; 
            margin: 0; 
            padding: 0;
            background-color: #f0f2f5; /* ì•½ê°„ ì–´ë‘ìš´ ë°°ê²½ */
        }
        h1 { color: #1e3c72; margin-bottom: 5px; padding-top: 15px; font-size: 1.8em; }
        p { color: #666; margin-bottom: 20px; font-size: 1em; }

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        #game-area {
            max-width: 450px; /* ëª¨ë°”ì¼ ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
            margin: 0 auto;
            padding: 20px 15px;
            background: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            min-height: 100vh; /* ëª¨ë°”ì¼ì—ì„œ ì „ì²´ í™”ë©´ ì‚¬ìš© */
        }
        
        /* ì…ë ¥ ë° ë²„íŠ¼ ì˜ì—­ */
        #input-area {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }

        #guessInput {
            padding: 12px;
            font-size: 1.4em; /* ì…ë ¥ê°’ í¬ê²Œ */
            width: 120px; 
            margin-right: 10px;
            border: 3px solid #ddd;
            border-radius: 8px;
            text-align: center;
            box-sizing: border-box;
        }
        
        button {
            padding: 12px 18px;
            font-size: 1.1em;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            height: 50px; /* ë²„íŠ¼ ë†’ì´ ì¡°ì • */
            box-sizing: border-box;
        }

        #submitBtn {
            background-color: #007bff;
            color: white;
        }
        #submitBtn:hover { background-color: #0056b3; }

        #restartBtn {
            background-color: #28a745;
            color: white;
            margin-left: 10px;
        }
        #restartBtn:hover { background-color: #1e7e34; }

        /* ê²°ê³¼ í‘œì‹œ ì˜ì—­ */
        #result {
            margin-top: 25px;
            padding: 15px;
            font-size: 1.3em;
            font-weight: bold;
            border-radius: 8px;
            background-color: #e3f2fd; /* ë°ì€ íŒŒë€ìƒ‰ ë°°ê²½ */
            color: #1565c0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        /* ê¸°ë¡ ì˜ì—­ */
        h2 { 
            font-size: 1.5em; 
            color: #444; 
            margin-top: 30px; 
            border-bottom: 2px solid #eee; 
            padding-bottom: 5px;
        }
        #history {
            list-style: none;
            padding: 0;
            margin-top: 15px;
            max-height: 30vh; /* ëª¨ë°”ì¼ì—ì„œ ìŠ¤í¬ë¡¤ ì˜ì—­ ì œí•œ */
            overflow-y: scroll;
            text-align: left;
        }
        #history li {
            padding: 10px 0;
            border-bottom: 1px dashed #ddd;
            font-size: 1.1em;
            color: #333;
        }

        /* S/B ê°•ì¡° ìƒ‰ìƒ */
        .strike { color: #dc3545; font-weight: bold; } 
        .ball { color: #007bff; font-weight: bold; }   
    </style>

    <script>
        $(document).ready(function() {
            let answer = [];      
            let attempts = 0;     
            const MAX_ATTEMPTS = 10;
            const DIGIT_COUNT = 3; 

            // ê²Œì„ ì´ˆê¸°í™” ë° ì •ë‹µ ìƒì„±
            function startGame() {
                answer = generateRandomNumber(DIGIT_COUNT);
                attempts = 0;
                $('#result').html(`ê²Œì„ ì‹œì‘! **${DIGIT_COUNT}ìë¦¬** ìˆ«ìë¥¼ **${MAX_ATTEMPTS}ë²ˆ** ì•ˆì— ë§ì¶°ë³´ì„¸ìš”.`);
                $('#history').empty();
                $('#guessInput').val('').prop('disabled', false).focus(); // ì‹œì‘ ì‹œ ì…ë ¥ í•„ë“œì— í¬ì»¤ìŠ¤
                $('#submitBtn').prop('disabled', false).show(); 
                $('#restartBtn').hide();
                console.log('ì •ë‹µ (ê°œë°œììš©): ' + answer.join('')); 
            }

            // ì¤‘ë³µ ì—†ëŠ” ëœë¤ ìˆ«ì ë°°ì—´ ìƒì„±
            function generateRandomNumber(count) {
                let numbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
                let result = [];
                
                for (let i = 0; i < count; i++) {
                    const index = Math.floor(Math.random() * numbers.length);
                    result.push(numbers[index]);
                    numbers.splice(index, 1);
                }
                return result;
            }

            // ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬ ë° ê²Œì„ ë¡œì§ ì‹¤í–‰
            $('#submitBtn').on('click', function() {
                const guessStr = $('#guessInput').val();
                
                // --- ì…ë ¥ê°’ ìœ íš¨ì„± ê²€ì‚¬ ---
                if (guessStr.length !== DIGIT_COUNT || !/^\d+$/.test(guessStr)) {
                    $('#result').html(`**ê²½ê³ :** ${DIGIT_COUNT}ìë¦¬ì˜ ìˆ«ìë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
                    return;
                }

                const guess = guessStr.split('').map(Number);
                
                // ì¤‘ë³µ ìˆ«ì ê²€ì‚¬
                if (new Set(guess).size !== DIGIT_COUNT) {
                    $('#result').html('**ê²½ê³ :** ì¤‘ë³µë˜ì§€ ì•Šì€ ìˆ«ìë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.');
                    return;
                }
                
                attempts++;
                const { strikes, balls } = calculateScore(guess);
                updateGameStatus(guessStr, strikes, balls);

                // --- ê²Œì„ ì¢…ë£Œ ì¡°ê±´ í™•ì¸ ---
                if (strikes === DIGIT_COUNT) {
                    endGame(true); // ìŠ¹ë¦¬
                } else if (attempts >= MAX_ATTEMPTS) {
                    endGame(false); // íŒ¨ë°°
                }
                
                $('#guessInput').val('').focus(); // ì…ë ¥ í›„ ë‹¤ì‹œ í¬ì»¤ìŠ¤
            });

            // ìŠ¤íŠ¸ë¼ì´í¬ì™€ ë³¼ ê³„ì‚°
            function calculateScore(guess) {
                let strikes = 0;
                let balls = 0;

                for (let i = 0; i < DIGIT_COUNT; i++) {
                    const guessDigit = guess[i];
                    const answerIndex = answer.indexOf(guessDigit);

                    if (answerIndex === i) {
                        strikes++; // ìˆ«ìì™€ ìœ„ì¹˜ ì¼ì¹˜ (Strike)
                    } else if (answerIndex !== -1) {
                        balls++; // ìˆ«ìë§Œ ì¼ì¹˜ (Ball)
                    }
                }
                return { strikes, balls };
            }

            // ê²Œì„ ìƒíƒœ ì—…ë°ì´íŠ¸ (ê²°ê³¼ ë° ê¸°ë¡)
            function updateGameStatus(guessStr, strikes, balls) {
                let resultText = '';
                let historyItem = `<span style="font-weight: bold;">[${attempts}íšŒ] ${guessStr}</span> : `;
                
                if (strikes > 0 || balls > 0) {
                    if (strikes > 0) {
                        resultText += `<span class="strike">${strikes}S</span>`;
                        historyItem += `${strikes}S`;
                    }
                    if (balls > 0) {
                        if (strikes > 0) {
                            resultText += ' ';
                            historyItem += ' ';
                        }
                        resultText += `<span class="ball">${balls}B</span>`;
                        historyItem += `${balls}B`;
                    }
                } else {
                    resultText = 'ì•„ì›ƒ (Out!)';
                    historyItem += 'Out';
                }
                
                $('#result').html(`ê²°ê³¼: ${resultText} (ë‚¨ì€ ê¸°íšŒ: ${MAX_ATTEMPTS - attempts}íšŒ)`);
                
                // ì‹œë„ ê¸°ë¡ ì¶”ê°€
                $('#history').prepend(`<li>${historyItem}</li>`);
            }
            
            // ê²Œì„ ì¢…ë£Œ ì²˜ë¦¬
            function endGame(isWin) {
                $('#guessInput').prop('disabled', true);
                $('#submitBtn').prop('disabled', true).hide();
                
                // ìŠ¹ë¦¬/íŒ¨ë°° ë©”ì‹œì§€ ê°•ì¡°
                let finalMessage;
                if (isWin) {
                    finalMessage = `ğŸ‰ **í™ˆëŸ°! ì¶•í•˜í•©ë‹ˆë‹¤!** ì •ë‹µ **${answer.join('')}**! **${attempts}ë²ˆ** ë§Œì— ì„±ê³µ!`;
                    $('#result').css('background-color', '#e8f5e9').css('color', '#388e3c'); // ìŠ¹ë¦¬ ìƒ‰ìƒ
                } else {
                    finalMessage = `ğŸ˜­ **ê²Œì„ ì˜¤ë²„!** ì •ë‹µì€ **${answer.join('')}**ì˜€ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë„ì „í•˜ì„¸ìš”!`;
                    $('#result').css('background-color', '#ffebee').css('color', '#d32f2f'); // íŒ¨ë°° ìƒ‰ìƒ
                }
                $('#result').html(finalMessage);
                $('#restartBtn').show();
            }

            // ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            $('#restartBtn').on('click', function() {
                // ë¦¬ì…‹ ì‹œ ê²°ê³¼ ë°°ê²½ìƒ‰ ì´ˆê¸°í™”
                $('#result').css('background-color', '#e3f2fd').css('color', '#1565c0');
                startGame();
            });

            // Enter í‚¤ (ëª¨ë°”ì¼ í‚¤íŒ¨ë“œì˜ 'ì™„ë£Œ' ì—­í• )ë¡œ ì œì¶œ ê¸°ëŠ¥ ì¶”ê°€
            $('#guessInput').on('keypress', function(e) {
                if (e.which === 13) { 
                    $('#submitBtn').click();
                    e.preventDefault(); 
                }
            });

            // í˜ì´ì§€ ë¡œë“œ ì‹œ ê²Œì„ ì‹œì‘
            startGame();
        });
    </script>
</head>
<body>
    <div id="game-area">
        <h1>âš¾ ìˆ«ì ì•¼êµ¬ ê²Œì„</h1>
        <p>0~9 ì¤‘ ì¤‘ë³µ ì—†ëŠ” **3ìë¦¬** ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>

        <div id="input-area">
            <input 
                type="number" 
                id="guessInput" 
                maxlength="3" 
                placeholder="000" 
                inputmode="numeric" 
                pattern="\d{3}"
            >
            <button id="submitBtn">í™•ì¸</button>
            <button id="restartBtn" style="display: none;">ë‹¤ì‹œ ì‹œì‘</button>
        </div>

        <div id="result">ê²Œì„ ì‹œì‘!</div>
        
        <h2>ì‹œë„ ê¸°ë¡</h2>
        <ul id="history"></ul>
    </div>
</body>
</html>
