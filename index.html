
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìˆ«ì ì•¼êµ¬ ê²Œì„ (ë‹¨ì¼ íŒŒì¼)</title>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            text-align: center; 
            margin: 0; 
            padding: 20px;
            background-color: #f4f4f9;
        }
        h1 { color: #333; margin-bottom: 5px; }
        p { color: #666; margin-bottom: 20px; }

        #game-area {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        #guessInput {
            padding: 10px;
            font-size: 1.2em;
            width: 150px;
            margin-right: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            text-align: center;
        }

        button {
            padding: 10px 15px;
            font-size: 1em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #submitBtn {
            background-color: #007bff;
            color: white;
        }
        #submitBtn:hover { background-color: #0056b3; }

        #restartBtn {
            background-color: #28a745;
            color: white;
            margin-left: 10px;
        }
        #restartBtn:hover { background-color: #1e7e34; }

        #result {
            margin-top: 20px;
            padding: 15px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 5px;
            background-color: #e9ecef;
            color: #333;
        }

        #history {
            list-style: none;
            padding: 0;
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
            border-top: 1px solid #eee;
        }
        #history li {
            padding: 8px 0;
            border-bottom: 1px dashed #eee;
            font-size: 0.95em;
            text-align: left;
        }

        .strike { color: #dc3545; font-weight: bold; } /* ë¹¨ê°„ìƒ‰ */
        .ball { color: #007bff; font-weight: bold; }   /* íŒŒë€ìƒ‰ */
    </style>

    <script>
        $(document).ready(function() {
            let answer = [];      // ì •ë‹µì„ ì €ì¥í•  ë°°ì—´
            let attempts = 0;     // ì‹œë„ íšŸìˆ˜
            const MAX_ATTEMPTS = 10;
            const DIGIT_COUNT = 4;

            // ê²Œì„ ì´ˆê¸°í™” ë° ì •ë‹µ ìƒì„±
            function startGame() {
                answer = generateRandomNumber(DIGIT_COUNT);
                attempts = 0;
                $('#result').html('ê²Œì„ ì‹œì‘! **10ë²ˆ** ì•ˆì— ë§ì¶°ë³´ì„¸ìš”.');
                $('#history').empty();
                $('#guessInput').val('').prop('disabled', false); 
                $('#submitBtn').prop('disabled', false).show(); 
                $('#restartBtn').hide();
                console.log('ì •ë‹µ (ê°œë°œììš©): ' + answer.join('')); 
            }

            // ì¤‘ë³µ ì—†ëŠ” ëœë¤ ìˆ«ì ë°°ì—´ ìƒì„±
            function generateRandomNumber(count) {
                let numbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
                let result = [];
                
                for (let i = 0; i < count; i++) {
                    const index = Math.floor(Math.random() * numbers.length);
                    result.push(numbers[index]);
                    numbers.splice(index, 1); // ì„ íƒëœ ìˆ«ì ì œê±°
                }
                return result;
            }

            // ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬ ë° ê²Œì„ ë¡œì§ ì‹¤í–‰
            $('#submitBtn').on('click', function() {
                const guessStr = $('#guessInput').val();
                
                // --- ì…ë ¥ê°’ ìœ íš¨ì„± ê²€ì‚¬ ---
                if (guessStr.length !== DIGIT_COUNT || !/^\d+$/.test(guessStr)) {
                    $('#result').html(`**ê²½ê³ :** ${DIGIT_COUNT}ìë¦¬ì˜ ìˆ«ìë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
                    return;
                }

                const guess = guessStr.split('').map(Number);
                
                // ì¤‘ë³µ ìˆ«ì ê²€ì‚¬
                if (new Set(guess).size !== DIGIT_COUNT) {
                    $('#result').html('**ê²½ê³ :** ì¤‘ë³µë˜ì§€ ì•Šì€ ìˆ«ìë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.');
                    return;
                }
                
                attempts++;
                const { strikes, balls } = calculateScore(guess);
                updateGameStatus(guessStr, strikes, balls);

                // --- ê²Œì„ ì¢…ë£Œ ì¡°ê±´ í™•ì¸ ---
                if (strikes === DIGIT_COUNT) {
                    endGame(true); // ìŠ¹ë¦¬
                } else if (attempts >= MAX_ATTEMPTS) {
                    endGame(false); // íŒ¨ë°°
                }
                
                $('#guessInput').val(''); // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            });

            // ìŠ¤íŠ¸ë¼ì´í¬ì™€ ë³¼ ê³„ì‚°
            function calculateScore(guess) {
                let strikes = 0;
                let balls = 0;

                for (let i = 0; i < DIGIT_COUNT; i++) {
                    const guessDigit = guess[i];
                    const answerIndex = answer.indexOf(guessDigit);

                    if (answerIndex === i) {
                        strikes++; // ìˆ«ìì™€ ìœ„ì¹˜ ì¼ì¹˜ (Strike)
                    } else if (answerIndex !== -1) {
                        balls++; // ìˆ«ìë§Œ ì¼ì¹˜ (Ball)
                    }
                }
                return { strikes, balls };
            }

            // ê²Œì„ ìƒíƒœ ì—…ë°ì´íŠ¸ (ê²°ê³¼ ë° ê¸°ë¡)
            function updateGameStatus(guessStr, strikes, balls) {
                let resultText = '';
                let historyItem = `[${attempts}íšŒ] ${guessStr} : `;
                
                if (strikes > 0) {
                    resultText += `<span class="strike">${strikes}S</span>`;
                    historyItem += `${strikes}S`;
                }
                if (balls > 0) {
                    if (strikes > 0) historyItem += ' ';
                    resultText += `<span class="ball">${balls}B</span>`;
                    historyItem += `${balls}B`;
                }
                
                if (strikes === 0 && balls === 0) {
                    resultText = 'ì•„ì›ƒ (Out!)';
                    historyItem += 'Out';
                }
                
                $('#result').html(`ê²°ê³¼: ${resultText} (ë‚¨ì€ ê¸°íšŒ: ${MAX_ATTEMPTS - attempts}íšŒ)`);
                
                // ì‹œë„ ê¸°ë¡ ì¶”ê°€ (prependë¡œ ìµœì‹  ê¸°ë¡ì´ ìœ„ë¡œ ì˜¤ë„ë¡)
                $('#history').prepend(`<li>${historyItem}</li>`);
            }
            
            // ê²Œì„ ì¢…ë£Œ ì²˜ë¦¬
            function endGame(isWin) {
                $('#guessInput').prop('disabled', true);
                $('#submitBtn').prop('disabled', true).hide();
                $('#restartBtn').show();
                
                if (isWin) {
                    $('#result').html(`ğŸ‰ **í™ˆëŸ°!** ì •ë‹µì€ **${answer.join('')}**! **${attempts}ë²ˆ** ë§Œì— ë§íˆì…¨ì–´ìš”!`);
                } else {
                    $('#result').html(`ğŸ˜­ **ê²Œì„ ì˜¤ë²„!** ì •ë‹µì€ **${answer.join('')}**ì˜€ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë„ì „í•´ë³´ì„¸ìš”!`);
                }
            }

            // ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            $('#restartBtn').on('click', startGame);

            // Enter í‚¤ë¡œ ì œì¶œ ê¸°ëŠ¥ ì¶”ê°€ (ëª¨ë°”ì¼ì—ì„œë„ ê°€ìƒ í‚¤ë³´ë“œì˜ 'ì™„ë£Œ' ë²„íŠ¼ ì—­í• ì„ í•  ìˆ˜ ìˆìŒ)
            $('#guessInput').on('keypress', function(e) {
                if (e.which === 13) { 
                    $('#submitBtn').click();
                    e.preventDefault(); 
                }
            });

            // í˜ì´ì§€ ë¡œë“œ ì‹œ ê²Œì„ ì‹œì‘
            startGame();
        });
    </script>
</head>
<body>
    <div id="game-area">
        <h1>ìˆ«ì ì•¼êµ¬ ê²Œì„</h1>
        <p>0~9 ì¤‘ ì¤‘ë³µ ì—†ëŠ” 4ìë¦¬ ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>

        <div>
            <input type="number" id="guessInput" maxlength="4" placeholder="4ìë¦¬ ìˆ«ì" inputmode="numeric">
            <button id="submitBtn">í™•ì¸</button>
            <button id="restartBtn" style="display: none;">ë‹¤ì‹œ ì‹œì‘</button>
        </div>

        <div id="result">ê²Œì„ ì‹œì‘!</div>
        
        <h2 style="font-size: 1.2em; margin-top: 20px;">ì‹œë„ ê¸°ë¡</h2>
        <ul id="history"></ul>
    </div>
</body>
</html>
